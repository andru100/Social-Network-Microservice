FROM golang:1.18-alpine

ARG SENDER_EMAIL
ARG HOSTIP
ARG LOCK_DURATION_1
ARG LOCK_DURATION_2
ARG LOCK_DURATION_3

WORKDIR /usr/src/app

COPY . .

ENV SENDER_EMAIL=${SENDER_EMAIL}

ENV HOSTIP=${HOSTIP}
ENV LOCK_DURATION_1=${LOCK_DURATION_1}
ENV LOCK_DURATION_2=${LOCK_DURATION_2}
ENV LOCK_DURATION_3=${LOCK_DURATION_3}

RUN go mod download

RUN go build -o /secureupdate-service

EXPOSE 4012

CMD ["/secureupdate-service"]